<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Set the viewport so the page scales well on mobile devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Classic Obstacle Dodger</title>
  <style>
    /* Reset and general styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body, html {
      height: 100%;
      font-family: Arial, sans-serif;
      background-color: #ff9800;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      overflow: hidden;
    }
    /* Header */
    header {
      text-align: center;
      margin: 10px;
      width: 100%;
      max-width: 1400px;
    }
    header h1 {
      font-size: 36px;
      color: white;
      font-weight: bold;
      margin-bottom: 10px;
    }
    /* Info Panel */
    #info-panel {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 10px;
    }
    #info-panel span {
      font-size: 24px;
      color: white;
      text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
    }
    /* Game Container */
    #game-container {
      position: relative;
      width: 100%;
      max-width: 1400px;
      height: 300px; /* Horizontally long (wide and short) */
      background: #222;
      border: 4px solid #fff;
      overflow: hidden;
      margin-bottom: 10px;
    }
    /* Game Area */
    #game-area {
      width: 100%;
      height: 100%;
      position: relative;
      background: linear-gradient(45deg, #009688, #4caf50);
      display: flex;
      align-items: flex-end;
      padding-bottom: 10px;
    }
    /* Player Styles */
    #player {
      font-size: 50px;
      position: absolute;
      bottom: 0;
      left: 10%;
      z-index: 2;
    }
    /* Dynamic objects: obstacles and apples */
    #obstacles, #apples {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }
    .obstacle, .apple {
      position: absolute;
      bottom: 0;
      font-size: 40px;
    }
    .obstacle {
      color: brown;
    }
    .apple {
      color: red;
    }
    /* Game Over Text */
    #game-over {
      position: absolute;
      top: 40%;
      width: 100%;
      text-align: center;
      font-size: 24px;
      color: red;
      font-weight: bold;
      display: none;
      z-index: 3;
    }
    /* Controls */
    #controls {
      margin-bottom: 10px;
    }
    #controls button {
      font-size: 24px;
      padding: 10px 15px;
      background-color: #009688;
      border: none;
      color: white;
      cursor: pointer;
      margin: 0 5px;
    }
    #controls button:hover {
      background-color: #004d40;
    }
    /* QR Code and Footer (outside game container) */
    footer {
      width: 100%;
      max-width: 1400px;
      display: flex;
      justify-content: flex-end;
      padding: 10px;
    }
    #qr-code {
      width: 120px;
    }
    /* Mobile Styles */
    @media (max-width: 768px) {
      #player {
        font-size: 40px;
      }
      #info-panel span {
        font-size: 18px;
      }
      #controls button {
        font-size: 18px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Classic Obstacle Dodger</h1>
    <div id="info-panel">
      <span id="score-text">Score: 0</span>
      <span id="level-text">Level: 1</span>
      <span id="rounds-text">Rounds: 0</span>
    </div>
  </header>
  <div id="game-container">
    <div id="game-area">
      <div id="player">üèÉ‚Äç‚û°Ô∏è</div>
      <div id="obstacles"></div>
      <div id="apples"></div>
      <p id="game-over">Game Over! Press Enter or Space to Restart</p>
    </div>
  </div>
  <div id="controls">
    <button id="start-button">Start Game</button>
    <button id="pause-button" style="display: none;">Pause</button>
    <button id="restart-button" style="display: none;">Restart Game</button>
    <button id="faq-button" style="display: none;">FAQ</button>
  </div>
  <footer>
    <a href="https://sites.google.com/view/staticquasar931" target="_blank" id="made-by-static">
      Made By Static
    </a>
    <!-- The QR code is placed in the footer, outside the gameplay area -->
    <img id="qr-code" src="https://res.cloudinary.com/dcsrqennd/image/upload/v1733694622/frame_1_vmv9y3.png" alt="QR Code" />
  </footer>

  <script>
    // ------------------- DOM Elements -------------------
    const gameArea = document.getElementById('game-area');
    const obstaclesContainer = document.getElementById('obstacles');
    const applesContainer = document.getElementById('apples');
    const player = document.getElementById('player');
    const scoreText = document.getElementById('score-text');
    const levelText = document.getElementById('level-text');
    const roundsText = document.getElementById('rounds-text');
    const gameOverText = document.getElementById('game-over');
    const startButton = document.getElementById('start-button');
    const pauseButton = document.getElementById('pause-button');
    const restartButton = document.getElementById('restart-button');
    const faqButton = document.getElementById('faq-button');

    // ------------------- Game Variables -------------------
    let score = 0;
    let level = 1;
    let rounds = 0;
    let isGameOver = false;
    let isPaused = false;
    let isJumping = false;

    // Timing & spawn variables (in milliseconds)
    let lastTime = null;
    let obstacleSpawnTimer = 0;
    let appleSpawnTimer = 0;
    const obstacleSpawnInterval = 2000;
    const appleSpawnInterval = 3000;

    // Speed settings (in pixels per second)
    let speed = 300;
    const jumpHeight = 150; // Maximum jump height in pixels

    // Arrays to store obstacles and apples
    let obstacles = [];
    let apples = [];

    // Game loop ID for requestAnimationFrame
    let gameLoopId = null;

    // ------------------- Event Listeners -------------------
    startButton.addEventListener('click', startGame);
    pauseButton.addEventListener('click', togglePause);
    restartButton.addEventListener('click', restartGame);
    faqButton.addEventListener('click', showFAQ);
    document.addEventListener('keydown', handleKeyPress);

    // ------------------- Game Loop -------------------
    function gameLoop(timestamp) {
      if (!lastTime) lastTime = timestamp;
      const dt = (timestamp - lastTime) / 1000; // delta time in seconds
      lastTime = timestamp;

      if (!isPaused && !isGameOver) {
        // Update spawn timers
        obstacleSpawnTimer += dt * 1000;
        appleSpawnTimer += dt * 1000;
        if (obstacleSpawnTimer >= obstacleSpawnInterval) {
          createObstacle();
          obstacleSpawnTimer = 0;
        }
        if (appleSpawnTimer >= appleSpawnInterval) {
          createApple();
          appleSpawnTimer = 0;
        }
        // Update game objects
        updateObstacles(dt);
        updateApples(dt);
        checkCollisions();
        updateUI();
      }
      // Request next frame if game is not over
      if (!isGameOver) {
        gameLoopId = requestAnimationFrame(gameLoop);
      }
    }

    // ------------------- Start / Restart / Pause -------------------
    function startGame() {
      rounds++;
      resetGame();
      gameOverText.style.display = 'none';
      startButton.style.display = 'none';
      pauseButton.style.display = 'inline-block';
      restartButton.style.display = 'inline-block';
      faqButton.style.display = 'inline-block';
      lastTime = null;
      gameLoopId = requestAnimationFrame(gameLoop);
    }

    function resetGame() {
      // Reset game variables
      score = 0;
      level = 1;
      isGameOver = false;
      isPaused = false;
      isJumping = false;
      speed = 300;
      obstacleSpawnTimer = 0;
      appleSpawnTimer = 0;
      // Reset player position (hitbox included)
      player.style.bottom = '0px';
      // Clear obstacles and apples
      obstacles.forEach(el => obstaclesContainer.removeChild(el));
      apples.forEach(el => applesContainer.removeChild(el));
      obstacles = [];
      apples = [];
      updateUI();
    }

    function togglePause() {
      isPaused = !isPaused;
      pauseButton.textContent = isPaused ? "Resume" : "Pause";
      if (!isPaused && !isGameOver) {
        lastTime = null;
        gameLoopId = requestAnimationFrame(gameLoop);
      }
    }

    function restartGame() {
      cancelAnimationFrame(gameLoopId);
      resetGame();
      gameOverText.style.display = 'none';
      lastTime = null;
      gameLoopId = requestAnimationFrame(gameLoop);
    }

    // ------------------- UI Updates -------------------
    function updateUI() {
      scoreText.textContent = `Score: ${score}`;
      levelText.textContent = `Level: ${level}`;
      roundsText.textContent = `Rounds: ${rounds}`;
    }

    // ------------------- Obstacle and Apple Creation -------------------
    function createObstacle() {
      if (isGameOver || isPaused) return;
      const obstacle = document.createElement('div');
      obstacle.classList.add('obstacle');
      obstacle.textContent = 'ü™µ';
      const startPos = gameArea.offsetWidth;
      obstacle.dataset.posX = startPos;
      obstacle.style.left = startPos + 'px';
      obstaclesContainer.appendChild(obstacle);
      obstacles.push(obstacle);
    }

    function updateObstacles(dt) {
      for (let i = obstacles.length - 1; i >= 0; i--) {
        const obstacle = obstacles[i];
        let posX = parseFloat(obstacle.dataset.posX);
        posX -= speed * dt;
        obstacle.dataset.posX = posX;
        obstacle.style.left = posX + 'px';
        if (posX < -50) {
          obstaclesContainer.removeChild(obstacle);
          obstacles.splice(i, 1);
          increaseScore();
        }
      }
    }

    function createApple() {
      if (isGameOver || isPaused) return;
      const apple = document.createElement('div');
      apple.classList.add('apple');
      apple.textContent = 'üçé';
      const startPos = gameArea.offsetWidth;
      apple.dataset.posX = startPos;
      apple.style.left = startPos + 'px';
      applesContainer.appendChild(apple);
      apples.push(apple);
    }

    function updateApples(dt) {
      for (let i = apples.length - 1; i >= 0; i--) {
        const apple = apples[i];
        let posX = parseFloat(apple.dataset.posX);
        posX -= speed * dt;
        apple.dataset.posX = posX;
        apple.style.left = posX + 'px';
        if (posX < -50) {
          applesContainer.removeChild(apple);
          apples.splice(i, 1);
        }
      }
    }

    // ------------------- Collision Detection -------------------
    function checkCollisions() {
      // Get the player's current bounding rectangle (including jump)
      const playerRect = player.getBoundingClientRect();
      // Check obstacles
      for (let i = 0; i < obstacles.length; i++) {
        const obsRect = obstacles[i].getBoundingClientRect();
        if (!(playerRect.right < obsRect.left ||
              playerRect.left > obsRect.right ||
              playerRect.bottom < obsRect.top ||
              playerRect.top > obsRect.bottom)) {
          endGame();
          return;
        }
      }
      // Check apples
      for (let i = apples.length - 1; i >= 0; i--) {
        const appleRect = apples[i].getBoundingClientRect();
        if (!(playerRect.right < appleRect.left ||
              playerRect.left > appleRect.right ||
              playerRect.bottom < appleRect.top ||
              playerRect.top > appleRect.bottom)) {
          score++;
          applesContainer.removeChild(apples[i]);
          apples.splice(i, 1);
          if (score % 10 === 0) {
            level++;
            speed += 50;
          }
        }
      }
    }

    function increaseScore() {
      score++;
      if (score % 10 === 0) {
        level++;
        speed += 50;
      }
    }

    function endGame() {
      isGameOver = true;
      gameOverText.style.display = 'block';
      cancelAnimationFrame(gameLoopId);
    }

    // ------------------- Player Jumping -------------------
    function jump() {
      if (isJumping || isGameOver) return;
      isJumping = true;
      const totalDuration = 600; // total jump time in ms
      let jumpStartTime = null;

      function animateJump(timestamp) {
        if (!jumpStartTime) jumpStartTime = timestamp;
        const elapsed = timestamp - jumpStartTime;
        const progress = elapsed / totalDuration;
        if (progress < 1) {
          let newBottom;
          if (progress < 0.5) {
            // Ascending
            newBottom = jumpHeight * (progress / 0.5);
          } else {
            // Descending
            newBottom = jumpHeight * (1 - ((progress - 0.5) / 0.5));
          }
          player.style.bottom = `${newBottom}px`;
          requestAnimationFrame(animateJump);
        } else {
          player.style.bottom = '0px';
          isJumping = false;
        }
      }
      requestAnimationFrame(animateJump);
    }

    // ------------------- Input Handling -------------------
    function handleKeyPress(event) {
      if (isGameOver && (event.key === " " || event.key === "Enter")) {
        restartGame();
        return;
      }
      if (!isGameOver && !isPaused && (event.key === " " || event.key === "w" || event.key === "Enter")) {
        jump();
      }
    }

    // ------------------- FAQ -------------------
    function showFAQ() {
      alert("FAQ:\n\nHow to Play:\n- Press Space, Enter, or W to jump over obstacles (ü™µ).\n- Collect apples (üçé) to increase your score.\n- Avoid obstacles to keep playing.\n\nHosted on GitHub Pages and Google Sites compatible!");
    }
  </script>
</body>
</html>
